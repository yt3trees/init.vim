"==================================================
"
" åŸºæœ¬è¨­å®š
"
"==================================================
" è¡Œç•ªå·ã‚’è¡¨ç¤º
set number
" ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã®è¡Œæ•°
set cmdheight=1
" ãƒã‚¦ã‚¹ã‚’æœ‰åŠ¹åŒ–
set mouse=a
" ç”»é¢ã‚’ç¸¦åˆ†å‰²ã™ã‚‹éš›ã«å³ã«é–‹ã
set splitright
" ç”»é¢ã‚’æ°´å¹³åˆ†å‰²ã™ã‚‹éš›ã«ä¸‹ã«é–‹ã
set splitbelow
" yank ã—ãŸæ–‡å­—åˆ—ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
set clipboard=unnamed
" ãƒãƒƒãƒ•ã‚¡ãŒç·¨é›†ä¸­ã§ã‚‚ãã®ä»–ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã‘ã‚‹ã‚ˆã†ã«
set hidden
" ã‚¹ãƒ¯ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚‰ãªã„
set noswapfile
" ã‚«ãƒ¼ã‚½ãƒ«ã®ã‚ã‚‹è¡Œã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆã™ã‚‹
set cursorline
" æ¤œç´¢æ™‚ã«å¤§æ–‡å­—å°æ–‡å­—ã‚’ç„¡è¦–ã™ã‚‹
set ignorecase 
" æ¤œç´¢æ™‚ã«å¤§æ–‡å­—ã‚’å«ã‚“ã§ã„ã‚‹å ´åˆã¯å¤§æ–‡å­—å°æ–‡å­—ã‚’åŒºåˆ¥ã™ã‚‹
set smartcase
" ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’è‡ªå‹•ã§ç§»å‹•
set autochdir
" è¡Œã‚’æŠ˜ã‚Šè¿”ã•ãªã„
set nowrap
" ãƒãƒƒãƒ•ã‚¡å†…ã§æ‰±ã†æ–‡å­—ã‚³ãƒ¼ãƒ‰(æ–‡å­—åˆ—)
set encoding=utf-8
" èª­ã¿è¾¼ã‚€æ–‡å­—ã‚³ãƒ¼ãƒ‰
set fileencodings=utf-8,utf-16le,sjis,cp932
" windowã®ä¸Šä¸‹10è¡Œã‚’scrolloffã«è¨­å®š
set scrolloff=10
" ãƒ•ã‚©ãƒ³ãƒˆã‚’è¨­å®š
set guifont=Iosevka\ Custom\ RD:h11
" ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ã‚‚ True Color ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹
set termguicolors
" ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’åŠé€æ˜åŒ–
set pumblend=10
" ä¸å¯è¦–æ–‡å­—ã®å¯è¦–åŒ–
set list
set listchars=eol:Â¬,tab:>-,trail:â‹…,space:â‹…,extends:Â»,precedes:Â«,nbsp:%
" è‡ªå‹•ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚„ã‚³ãƒãƒ³ãƒ‰ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã®å¹…
set shiftwidth=4
" Tabã‚­ãƒ¼ã§æŒ¿å…¥ã™ã‚‹ã‚¹ãƒšãƒ¼ã‚¹ã®æ•°
set softtabstop=4
" ä½•å€‹åˆ†ã®ã‚¹ãƒšãƒ¼ã‚¹ã§1ã¤ã®ã‚¿ãƒ–ã¨ã—ã¦ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹ã‹
set tabstop=4
" ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã«åˆã‚ã›ã¦é©åˆ‡ã«ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’è‡ªå‹•æŒ¿å…¥
set smartindent
" ã‚¿ãƒ–ã‚’ã‚¹ãƒšãƒ¼ã‚¹ã«ç½®ãæ›ãˆã‚‹
set expandtab


"==================================================
"
" ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰
"
"==================================================
" Leaderã‚­ãƒ¼ã‚’è¨­å®š
let mapleader = "\<Space>"
" jjã‹jkã§æŒ¿å…¥ãƒ¢ãƒ¼ãƒ‰ã‹ã‚‰ãƒãƒ¼ãƒãƒ«ãƒ¢ãƒ¼ãƒ‰ã«æˆ»ã‚‹
inoremap <silent> jj <Esc>
inoremap <silent> jk <Esc>
inoremap <silent> ã£ï½Š <Esc>
inoremap <silent> ï½Šï½‹ <Esc>
" å…¨é¸æŠ
nnoremap <C-a> gg<S-v>G
" ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜
nnoremap <silent> <C-s> :w<Return>
inoremap <silent> <C-s> <ESC>:w<Return>
" ã‚¿ãƒ–ã‚’è¿½åŠ 
nnoremap te :tabedit<Return>
" ã‚¿ãƒ–ã‚’é–‰ã˜ã‚‹
nnoremap tc :tabclose<Return>
" ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚µã‚¤ã‚ºèª¿æ•´
nnoremap <C-w><left> <C-w><
nnoremap <C-w><right> <C-w>>
nnoremap <C-w><up> <C-w>+
nnoremap <C-w><down> <C-w>-
" è¡¨ç¤ºè¡Œç§»å‹•
nnoremap j gj
nnoremap k gk
vnoremap j gj
vnoremap k gk
" Move tab
noremap <silent> <C-l> :tabnext<Enter>
noremap <silent> <C-h> :tabprev<Enter>
noremap <Tab>  <Cmd>BufferLineCycleNext<CR>
noremap <S-Tab>  <Cmd>BufferLineCyclePrev<CR>
" edgemotion
noremap <C-j> <Plug>(edgemotion-j)
noremap <C-k> <Plug>(edgemotion-k)
" release select
nnoremap <Esc><Esc> :nohl<CR>
" ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ãƒ¢ãƒ¼ãƒ‰ã‹ã‚‰æŠœã‘ã‚‹
:tnoremap <Esc> <C-\><C-n>
" è¡Œã‚’å…¥ã‚Œæ›ãˆã‚‹
noremap <A-up> ddkP 
noremap <A-down> ddp
" æ¬¡ã®è¡Œã«æ”¹è¡Œ
inoremap <C-CR> <ESC>o
inoremap <C-S-CR> <ESC>ko
" ãƒãƒƒãƒ•ã‚¡ã‚’ãƒªã‚¹ãƒˆã‹ã‚‰æŒ‡å®šã—ã¦é–‹ã
" nnoremap <C-b> <cmd>call quickui#tools#list_buffer('tabedit')<CR>
nnoremap <C-b> <cmd>Telescope buffers<CR>
" Telescope
nnoremap <leader>ff <cmd>Telescope find_files<CR>
nnoremap <leader>fg <cmd>Telescope live_grep<CR>
" nnoremap <leader>fb <cmd>Telescope buffers<CR>
nnoremap <leader>fh <cmd>Telescope help_tags<CR>
nnoremap <leader>fb <cmd>Telescope file_browser<CR>
" Neo-treeã‚’è¡¨ç¤º
nnoremap <leader>e <cmd>Neotree<CR>
" æ¤œç´¢æ–‡å­—ã«ç§»å‹•
nmap s <Plug>Sneak_s
nmap S <Plug>Sneak_S
nmap f <Plug>Sneak_f
nmap F <Plug>Sneak_F
" UndoTreeã‚’è¡¨ç¤º
nnoremap <leader>u :UndotreeToggle<CR>
" treesitter playground
nnoremap <leader>; :TSPlaygroundToggle<CR>
nnoremap <leader>: :TSHighlightCapturesUnderCursor<CR>
nnoremap <leader>' :TSEditQueryUserAfter highlights 
nnoremap <leader>" :TSEditQuery highlights 
" vim-quickhl
nnoremap <Space>m <Plug>(quickhl-manual-this)
xnoremap <Space>m <Plug>(quickhl-manual-this)
nnoremap <Space>M <Plug>(quickhl-manual-reset)
xnoremap <Space>M <Plug>(quickhl-manual-reset)


"==================================================
"
" ãƒ—ãƒ©ã‚°ã‚¤ãƒ³
"
"==================================================
" è¶³ã‚Šãªã„ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒã‚ã‚Œã° :PlugInstall ã‚’å®Ÿè¡Œ
autocmd VimEnter * if len(filter(values(g:plugs), '!isdirectory(v:val.dir)'))
  \| PlugInstall --sync | source $MYVIMRC
\| endif

" vim-plug :PlugInstall or :PlugClean
call plug#begin('/plugged')
" ã‚«ãƒ©ãƒ¼ã‚¹ã‚­ãƒ¼ãƒ 
Plug 'projekt0n/github-nvim-theme'
" é–‹ã„ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’è¦‹ã¦expandtabç­‰ã‚’è‡ªå‹•è¨­å®š
Plug 'tpope/vim-sleuth'
" :helpã‚’æ—¥æœ¬èªåŒ–
Plug 'vim-jp/vimdoc-ja'
" é€šçŸ¥
Plug 'rcarriga/nvim-notify'
" UIã‚’ç½®ãæ›ãˆ
Plug 'folke/noice.nvim'
" Luaç”¨
Plug 'nvim-lua/plenary.nvim'
" ãƒ•ã‚¡ã‚¸ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ³ãƒ€ãƒ¼
Plug 'nvim-telescope/telescope.nvim', { 'tag': '0.1.0' }
Plug 'nvim-telescope/telescope-file-browser.nvim'
" ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆ
Plug 'nvim-treesitter/nvim-treesitter',{'merged': ':0'}
Plug 'nvim-treesitter/playground'
Plug 'p00f/nvim-ts-rainbow'
" ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ©ã‚¤ãƒ³
Plug 'nvim-lualine/lualine.nvim'
Plug 'kyazdani42/nvim-web-devicons'
" ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
Plug 'folke/trouble.nvim'
" ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼
Plug 'dstein64/nvim-scrollview', { 'branch': 'main' }
" ã‚¿ãƒ–ãƒãƒ¼ã®è£…é£¾
Plug 'akinsho/bufferline.nvim', { 'tag': 'v3.*' }
" ã‚«ãƒ¼ã‚½ãƒ«ãŒå½“ãŸã£ãŸå˜èªã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
Plug 'RRethy/vim-illuminate'
" ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯
Plug 'MattesGroeger/vim-bookmarks'
" ç¸¦æ–¹å‘ç§»å‹•ã®è£œåŠ©
Plug 'haya14busa/vim-edgemotion'
" æ¤œç´¢æ™‚ã«ä½•å€‹ç›®ã«ãƒãƒƒãƒã—ãŸã‚‚ã®ã‹ã‚’è¡¨ç¤º
" Plug 'kevinhwang91/nvim-hlslens'
Plug 'rapan931/bistahieversor.nvim'
" è‡ªå‹•è£œå®Œ
Plug 'neovim/nvim-lspconfig'
Plug 'glepnir/lspsaga.nvim', { 'branch': 'main' }
Plug 'hrsh7th/cmp-nvim-lsp'
Plug 'hrsh7th/cmp-buffer'
Plug 'hrsh7th/cmp-path'
Plug 'hrsh7th/cmp-cmdline'
Plug 'hrsh7th/nvim-cmp'
Plug 'hrsh7th/cmp-vsnip'
Plug 'hrsh7th/vim-vsnip'
Plug 'andymass/vim-matchup'
" LSPç®¡ç†
Plug 'williamboman/mason.nvim'
Plug 'williamboman/mason-lspconfig.nvim'
" é–¢æ•°ã®ã‚·ã‚°ãƒãƒãƒ£ãƒ˜ãƒ«ãƒ—ã‚’è¡¨ç¤º
Plug 'ray-x/lsp_signature.nvim'
" lspã®çŠ¶æ…‹ã‚’è¡¨ç¤º
Plug 'j-hui/fidget.nvim'
" ãƒ‡ãƒãƒƒã‚°
Plug 'mfussenegger/nvim-dap'
Plug 'rcarriga/nvim-dap-ui'
Plug 'theHamsta/nvim-dap-virtual-text'
Plug 'mfussenegger/nvim-dap-python'
" ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ
Plug 'numToStr/Comment.nvim'
" ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã®å¯è¦–åŒ–
Plug 'lukas-reineke/indent-blankline.nvim'
" Git
Plug 'TimUntersberger/neogit'
Plug 'sindrets/diffview.nvim'
" Gitã®çŠ¶æ…‹ã‚’è¡¨ç¤º
Plug 'lewis6991/gitsigns.nvim'
" ã‚«ãƒ¼ã‚½ãƒ«ãŒã„ã‚‹è¡Œã®ã‚³ãƒŸãƒƒãƒˆæƒ…å ±ã‚’è¡¨ç¤º
Plug 'rhysd/git-messenger.vim'
" git blameã‚’è¡¨ç¤º
Plug 'APZelos/blamer.nvim'
" NerdFont
Plug 'lambdalisue/nerdfont.vim'
" èµ·å‹•ç”»é¢
Plug 'goolord/alpha-nvim'
" AIè£œå®Œ
Plug 'tzachar/cmp-tabnine', { 'do': 'powershell ./install.ps1' }
Plug 'github/copilot.vim'
" è£œå®Œæ™‚ã«ã‚¢ã‚¤ã‚³ãƒ³ã‚’è¡¨ç¤º
Plug 'onsails/lspkind.nvim'
" è‰²ã‚³ãƒ¼ãƒ‰éƒ¨åˆ†ã«è‰²ã‚’ä»˜ä¸
Plug 'norcalli/nvim-colorizer.lua'
" ãƒ•ã‚¡ã‚¤ãƒ«ãƒ„ãƒªãƒ¼
Plug 'nvim-neo-tree/neo-tree.nvim'
Plug 'MunifTanjim/nui.nvim'
Plug 's1n7ax/nvim-window-picker'
" æ¤œç´¢æ–‡å­—ã«ç§»å‹•
Plug 'justinmk/vim-sneak'
" ãƒãƒ«ãƒã‚«ãƒ¼ã‚½ãƒ«
Plug 'mg979/vim-visual-multi', {'branch': 'master'}
" fã§é£›ã¹ã‚‹å˜èªã‚’ç€è‰²
Plug 'unblevable/quick-scope' 
" å¤‰æ›´å±¥æ­´ã‚’ãƒ„ãƒªãƒ¼è¡¨ç¤º
Plug 'mbbill/undotree'
" ãƒ¬ã‚¸ã‚¹ã‚¿ã®å†…å®¹ã‚’è¡¨ç¤º
Plug 'tversteeg/registers.nvim', { 'branch': 'main' }
" å˜èªã‚’ãƒãƒ¼ã‚¯ã™ã‚‹
Plug 't9md/vim-quickhl'
" ãƒ¡ãƒ‹ãƒ¥ãƒ¼
Plug 'skywind3000/vim-quickui'
" å…¥åŠ›ã‚’é–‹å§‹ã—ãŸã‚³ãƒãƒ³ãƒ‰ã®ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ã‚’è¡¨ç¤º
Plug 'folke/which-key.nvim'
call plug#end()


"==================================================
"
" ãƒ—ãƒ©ã‚°ã‚¤ãƒ³è©³ç´°è¨­å®š
"
"==================================================
"-------------------------
" fvim-illuminate
"-------------------------
" illuminateã®ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’ä¸‹ç·šã§ã¯ãªãèƒŒæ™¯ã«è¨­å®š
hi LspReferenceText gui=underline
hi LspReferenceWrite gui=underline
hi LspReferenceText gui=underline
autocmd VimEnter * hi LspReferenceText cterm=inverse gui=inverse
autocmd VimEnter * hi LspReferenceRead cterm=inverse gui=inverse
autocmd VimEnter * hi LspReferenceWrite cterm=inverse gui=inverse
hi link IlluminatedWordText Visual
hi link IlluminatedWordRead Visual
hi link IlluminatedWordWrite Visual

"-------------------------
" zenhan
"-------------------------
" æŒ¿å…¥ãƒ¢ãƒ¼ãƒ‰çµ‚äº†æ™‚ã«IMEã‚’ã‚ªãƒ•
if executable('zenhan')
autocmd InsertLeave * :call system('zenhan 0')
autocmd CmdlineLeave * :call system('zenhan 0')
endif

"-------------------------
" telescope.nvim
"-------------------------
lua << EOF
-- IMPORTANT!: this is only a showcase of how you can set default options!
require("telescope").setup {
  extensions = {
    file_browser = {
      theme = "ivy",
      -- disables netrw and use telescope-file-browser in its place
      hijack_netrw = true,
      mappings = {
        ["i"] = {
          -- your custom insert mode mappings
        },
        ["n"] = {
          -- your custom normal mode mappings
        },
      },
    },
  },
}
-- To get telescope-file-browser loaded and working with telescope,
-- you need to call load_extension, somewhere after setup function:
require("telescope").load_extension "file_browser"
EOF

"-------------------------
" gitsigns.nvim
"-------------------------
lua << EOF
require('gitsigns').setup()
EOF

"-------------------------
" nvim-cmp
"-------------------------
lua << EOF
local cmp = require'cmp'

local lspkind = require('lspkind')
local source_mapping = {
        buffer      = "[Buffer]",
        nvim_lsp    = "[LSP]",
        nvim_lua    = "[Lua]",
        vsnip       = "[Vsnip]",
        cmp_tabnine = "[TN]",
        path        = "[Path]",
        git         = "[Git]",
        cmdline     = "[Cmdline]",
}

cmp.setup({
    snippet = {
    -- REQUIRED - you must specify a snippet engine
    expand = function(args)
      vim.fn["vsnip#anonymous"](args.body) -- For `vsnip` users.
      -- require('luasnip').lsp_expand(args.body) -- For `luasnip` users.
      -- require('snippy').expand_snippet(args.body) -- For `snippy` users.
      -- vim.fn["UltiSnips#Anon"](args.body) -- For `ultisnips` users.
      end,
    },
    window = {
      -- completion = cmp.config.window.bordered(),
      -- documentation = cmp.config.window.bordered(),
    },
    mapping = cmp.mapping.preset.insert({
        ["<up>"] = cmp.mapping.select_prev_item(select_opts),
        ["<down>"] = cmp.mapping.select_next_item(select_opts),
        ["<C-p>"] = cmp.mapping(function()
            if cmp.visible() then
                cmp.select_prev_item()
            else
                cmp.complete()
            end
        end, { 'i', 'c' }),
        ["<C-n>"] = cmp.mapping(function()
            if cmp.visible() then
                cmp.select_next_item()
            else
                cmp.complete()
            end
        end, { 'i', 'c' }),
        ['<C-b>'] = cmp.mapping.scroll_docs(-4),
        ['<C-f>'] = cmp.mapping.scroll_docs(4),
        ['<C-Space>'] = cmp.mapping.complete(),
        ['<C-e>'] = cmp.mapping.abort(),
        ['<CR>'] = cmp.mapping.confirm({ select = false }), -- Accept currently selected item. Set `select` to `false` to only confirm explicitly selected items.
    }),
    sources = cmp.config.sources({
      { name = 'nvim_lsp' },
      { name = 'vsnip' }, -- For vsnip users.
      -- { name = 'luasnip' }, -- For luasnip users.
      -- { name = 'ultisnips' }, -- For ultisnips users.
      -- { name = 'snippy' }, -- For snippy users.
      { name = 'buffer' },
      { name = 'path' },
      { name = 'git' },
      { name = 'cmdline' },
      { name = 'cmp_tabnine' },
    }),
    formatting = {
    format = function(entry, vim_item)
        vim_item.kind = lspkind.presets.default[vim_item.kind]
        local menu = source_mapping[entry.source.name]
        if entry.source.name == 'cmp_tabnine' then
            if entry.completion_item.data ~= nil and entry.completion_item.data.detail ~= nil then
            menu = entry.completion_item.data.detail .. ' ' .. menu
            end
            vim_item.kind = 'ïƒ§'
        end
        vim_item.menu = menu
    return vim_item
    end
    },
  })

  -- Set configuration for specific filetype.
  cmp.setup.filetype('gitcommit', {
    sources = cmp.config.sources({
      { name = 'cmp_git' }, -- You can specify the `cmp_git` source if you were installed it.
    }, {
      { name = 'buffer' },
    })
  })

  -- Use buffer source for `/` (if you enabled `native_menu`, this won't work anymore).
  cmp.setup.cmdline('/', {
    mapping = cmp.mapping.preset.cmdline(),
    sources = {
      { name = 'buffer' }
    }
  })

  -- Use cmdline & path source for ':' (if you enabled `native_menu`, this won't work anymore).
  cmp.setup.cmdline(':', {
    mapping = cmp.mapping.preset.cmdline(),
    sources = cmp.config.sources({
      { name = 'path' }
    }, {
      { name = 'cmdline' }
    })
  })
  -- Setup lspconfig.
  local capabilities = require('cmp_nvim_lsp').default_capabilities()
  -- Replace <YOUR_LSP_SERVER> with each lsp server you've enabled.
--  require('lspconfig')['<YOUR_LSP_SERVER>'].setup {
--    capabilities = capabilities
--  }

local tabnine = require('cmp_tabnine.config')
tabnine.setup({
    max_lines = 1000,
    max_num_results = 20,
    sort = true,
    run_on_every_keystroke = true,
    snippet_placeholder = '..',
    ignored_file_types = { 
        -- default is not to ignore
        -- uncomment to ignore in lua:
        -- lua = true
    },
    show_prediction_strength = false
})
EOF

"-------------------------
" lspsaga.nvim
"-------------------------
lua << EOF
local saga = require('lspsaga')
saga.init_lsp_saga({
  finder_action_keys = {
    open = "<CR>",
    vsplit = "v",
    split = "s",
    tabe = "t",
    quit = "q",
  },
  definition_action_keys = {
    edit = '<C-c><CR>',
    vsplit = '<C-c>v',
    split = '<C-c>s',
    tabe = '<C-c>t',
    quit = 'q',
},
})
EOF

"-------------------------
" lsp_signature.nvim
"-------------------------
lua << EOF
require "lsp_signature".setup()
EOF

"-------------------------
" nvim-treesitter
"-------------------------
lua << EOF
require'nvim-treesitter.configs'.setup {
    ensure_installed = {
            "c_sharp",
            "sql",
            "markdown",
            "markdown_inline",
       --     "vim",
            "tsx",
            "python",
            "json",
            "html",
            "css",
            "scss",
        },
    highlight = {
        enable = true,  -- syntax highlightã‚’æœ‰åŠ¹ã«ã™ã‚‹
--        disable = {     -- ä¸€éƒ¨ã®è¨€èªã§ã¯ç„¡åŠ¹ã«ã™ã‚‹
--            'c_sharp',
--        }
    },
    matchup = {
            enable = true,
        }
}
EOF

" vscodeã®å ´åˆã¯treesitterã‚’ç„¡åŠ¹åŒ–ã™ã‚‹
if exists('g:vscode')
lua << EOF
require'nvim-treesitter.configs'.setup {
  highlight = {
    enable = false,
  }
  }
EOF
endif

"-------------------------
" nvim-ts-rainbow
"-------------------------
lua << EOF
require("nvim-treesitter.configs").setup {
  highlight = {
      -- ...
  },
  -- ...
  rainbow = {
    enable = true,
    -- disable = { "jsx", "cpp" }, list of languages you want to disable the plugin for
    extended_mode = false, -- Also highlight non-bracket delimiters like html tags, boolean or table: lang -> boolean
    max_file_lines = 5000, -- Do not enable for files with more than n lines, int
    colors = {
      "#79b8ff",
      "#ffab70",
      "#b392f0",
    }
    -- termcolors = {} -- table of colour name strings
  }
}
EOF

" vscodeã®å ´åˆã¯ts-rainbowã‚’ç„¡åŠ¹åŒ–ã™ã‚‹
if exists('g:vscode')
lua << EOF
require("nvim-treesitter.configs").setup {
  rainbow = {
    enable = false,
  }
}
EOF
endif
"-------------------------
" vim-illuminate
"-------------------------
lua << EOF
require('illuminate').configure({
    -- providers: provider used to get references in the buffer, ordered by priority
    providers = {
        'lsp',
        'treesitter',
        'regex',
    },
    -- delay: delay in milliseconds
    delay = 100,
    -- filetypes_denylist: filetypes to not illuminate, this overrides filetypes_allowlist
    filetypes_denylist = {
        'dirvish',
        'fugitive',
    },
    -- filetypes_allowlist: filetypes to illuminate, this is overriden by filetypes_denylist
    filetypes_allowlist = {},
    -- modes_denylist: modes to not illuminate, this overrides modes_allowlist
    modes_denylist = {},
    -- modes_allowlist: modes to illuminate, this is overriden by modes_denylist
    modes_allowlist = {},
    -- providers_regex_syntax_denylist: syntax to not illuminate, this overrides providers_regex_syntax_allowlist
    -- Only applies to the 'regex' provider
    -- Use :echom synIDattr(synIDtrans(synID(line('.'), col('.'), 1)), 'name')
    providers_regex_syntax_denylist = {},
    -- providers_regex_syntax_allowlist: syntax to illuminate, this is overriden by providers_regex_syntax_denylist
    -- Only applies to the 'regex' provider
    -- Use :echom synIDattr(synIDtrans(synID(line('.'), col('.'), 1)), 'name')
    providers_regex_syntax_allowlist = {},
    -- under_cursor: whether or not to illuminate under the cursor
    under_cursor = true,
})
EOF

"-------------------------
" Comment.nvim
"-------------------------
lua << EOF
require('Comment').setup()
EOF

"-------------------------
" indent-blankline.nvim
"-------------------------
lua << EOF
require("indent_blankline").setup {
    space_char_blankline = " ",
    show_current_context = true,
    show_current_context_start = true,
}
EOF

"-------------------------
" mason.nvim
"-------------------------
lua << EOF
require("mason").setup({
    ui = {
        icons = {
            package_installed = "âœ“",
            package_pending = "âœ",
            package_uninstalled = "âœ—"
        }
    }
})
EOF

"-------------------------
" mason-lspconfig.nvim
"-------------------------
lua << EOF
require('mason-lspconfig').setup_handlers({ function(server)
  local opt = {
    -- -- Function executed when the LSP server startup
    -- on_attach = function(client, bufnr)
    --   local opts = { noremap=true, silent=true }
    --   vim.api.nvim_buf_set_keymap(bufnr, 'n', 'K', '<cmd>lua vim.lsp.buf.hover()<CR>', opts)
    --   vim.cmd 'autocmd BufWritePre * lua vim.lsp.buf.formatting_sync(nil, 1000)'
    -- end,
    capabilities = require('cmp_nvim_lsp').default_capabilities()
  }
  require('lspconfig')[server].setup(opt)
end,
})
require'lspconfig'.omnisharp.setup {
    cmd = {"OmniSharp.exe","--languageserver"} -- ãƒ‘ã‚¹ã‚’é€šã—ã¦ãŠãå¿…è¦ã‚ã‚Š
    }
require'lspconfig'.powershell_es.setup {
    bundle_path = "~/AppData/Local/nvim-data/mason/packages/powershell-editor-services"
    }
EOF

"-------------------------
" mason-lspconfig.nvim
"-------------------------
lua << EOF
local neogit = require('neogit')
neogit.setup {
    integrations = {
    diffview = true
    }
    }
local actions = require("diffview.actions")
require("diffview").setup({})
EOF

"-------------------------
" trouble.nvim
"-------------------------
lua << EOF
  require("trouble").setup {
    -- your configuration comes here
    -- or leave it empty to use the default settings
    -- refer to the configuration section below
  }
EOF

"-------------------------
" alpha-nvim
"-------------------------
lua << EOF
require'alpha'.setup(require'alpha.themes.dashboard'.config)
EOF

"-------------------------
" folke/which-key.nvim
"-------------------------
lua << EOF
local wk = require("which-key")
wk.setup()
EOF

"-------------------------
" fidget.nvim
"-------------------------
lua << EOF
require"fidget".setup{}
EOF

"-------------------------
" nvim-colorizer.lua
"-------------------------
if exists('+termguicolors')
  let &t_8f="\<Esc>[38;2;%lu;%lu;%lum"
  let &t_8b="\<Esc>[48;2;%lu;%lu;%lum"
  set termguicolors
endif
lua require'colorizer'.setup()

"-------------------------
" nvim-window-picker
"-------------------------
lua << EOF
require 'window-picker'.setup{}
EOF

"-------------------------
" neo-tree.nvim
"-------------------------
lua << EOF
require("neo-tree").setup({
        window = {
          position = "left",
          width = 30,
          mapping_options = {
            noremap = true,
            nowait = true,
          },
          mappings = {
            ["<space>"] = { 
                "toggle_node", 
                nowait = false, -- disable `nowait` if you have existing combos starting with this char that you want to use 
            },
            ["<2-LeftMouse>"] = "open",
            ["<CR>"] = "open",
            ["S"] = "none",
            ["s"] = "none",
            -- ["S"] = "split_with_window_picker",
            -- ["s"] = "vsplit_with_window_picker",
            ["t"] = "open_tabnew",
            ["w"] = "open_with_window_picker",
            --["P"] = "toggle_preview", -- enter preview mode, which shows the current node without focusing
            ["C"] = "close_node",
            ["z"] = "close_all_nodes",
            --["Z"] = "expand_all_nodes",
            ["a"] = { 
              "add",
              -- some commands may take optional config options, see `:h neo-tree-mappings` for details
              config = {
                show_path = "none" -- "none", "relative", "absolute"
              }
            },
            ["A"] = "add_directory", -- also accepts the optional config.show_path option like "add".
            ["d"] = "delete",
            ["r"] = "rename",
            ["y"] = "copy_to_clipboard",
            ["x"] = "cut_to_clipboard",
            ["p"] = "paste_from_clipboard",
            ["c"] = "copy", -- takes text input for destination, also accepts the optional config.show_path option like "add":
            -- ["c"] = {
            --  "copy",
            --  config = {
            --    show_path = "none" -- "none", "relative", "absolute"
            --  }
            --}
            ["m"] = "move", -- takes text input for destination, also accepts the optional config.show_path option like "add".
            ["q"] = "close_window",
            ["R"] = "refresh",
            ["?"] = "show_help",
            ["<"] = "prev_source",
            [">"] = "next_source",
          }
        }
     })
EOF

"-------------------------
" github-nvim-theme
"-------------------------
lua << EOF
require('github-theme').setup({
    theme_style = "dark",
    comment_style = "NONE",
    transparent = "true",
--    colors = {
--        bg_search = '#282c34',
--    }
    overrides = function(c)
    return {
  --   comment = { fg = '#7a8a99' },
    }
  end,
  dev = true,
})
EOF

"-------------------------
" lualine.nvim
"-------------------------
lua << EOF
function searchCount()
  local search = vim.fn.searchcount({maxcount = 0}) -- maxcount = 0 makes the number not be capped at 99
  local searchCurrent = search.current
  local searchTotal = search.total
  if searchCurrent > 0 then
    return "/"..vim.fn.getreg("/").." ["..searchCurrent.."/"..searchTotal.."]"
  else
    return ""
  end
end

require('lualine').setup {
  options = {
    icons_enabled = true,
    theme = 'auto',
    component_separators = { left = 'î‚±', right = 'î‚³'},
    section_separators = { left = 'î‚°', right = 'î‚²'},
    disabled_filetypes = {
      statusline = {},
      winbar = {},
    },
    ignore_focus = {},
    always_divide_middle = true,
    globalstatus = false,
    refresh = {
      statusline = 1000,
      tabline = 1000,
      winbar = 1000,
    }
  },
  sections = {
    lualine_a = {'mode'},
    lualine_b = {'branch', 'diff', 'diagnostics'},
    lualine_c = {{'filename', file_status=true, path=3}},
    lualine_x = {
      {searchCount},'encoding', 'fileformat', 'filetype'
    },
    lualine_y = {'progress'},
    lualine_z = {'location'}
  },
  inactive_sections = {
    lualine_a = {},
    lualine_b = {},
    lualine_c = {'filename'},
    lualine_x = {'location'},
    lualine_y = {},
    lualine_z = {}
  },
  tabline = {},
  winbar = {},
  inactive_winbar = {},
  extensions = {}
}
EOF

"-------------------------
" bufferline.nvim
"-------------------------
lua << EOF
local status, bufferline = pcall(require, "bufferline")
if (not status) then return end

bufferline.setup({
  options = {
     mode = 'tabs',
     indicator = { style = "icon", icon = "â–" },
     separator_style = { '', '' },
     --tab_size = 0,
     modified_icon = 'ï‘„',
     show_buffer_close_icons = true,
     show_close_icon = true,
     color_icons = true,
     always_show_bufferline = false,
  },
})
EOF

"-------------------------
" nvim-notify
"-------------------------
lua << EOF
require("notify").setup({
  background_colour = "#000000",
})
EOF

"-------------------------
" noice.nvim
"-------------------------
if !exists('g:vscode')
lua << EOF
require('noice').setup({
-- views = {
--       cmdline_popup = {
--         border = {
--           style = "none",
--           padding = { 2, 3 },
--         },
--         filter_options = {},
--         win_options = {
--           winhighlight = "NormalFloat:NormalFloat,FloatBorder:FloatBorder",
--         },
--       },
--     },
  routes = {
      -- æ¤œç´¢ã®ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’éè¡¨ç¤º
      {
        filter = {
          event = "msg_show",
          ["not"] = { kind = "search_count" },
        },
        opts = { skip = true },
      },
      -- -- virtual textã‚’éè¡¨ç¤º
      {
        filter = {
          event = "msg_show",
          kind = "search_count",
        },
        opts = { skip = true },
      },
  }
})
EOF
endif

"-------------------------
" vim-sneak
"-------------------------
highlight Sneak ctermfg=8 ctermbg=0
augroup ApplyHighlight
    autocmd!
    autocmd ColorScheme * highlight Sneak ctermfg=8 ctermbg=0
augroup end

"-------------------------
" APZelos/blamer.nvim
"-------------------------
let g:blamer_enabled = 1
let g:blamer_delay = 300
let g:blamer_date_format = '%y/%m/%d %H:%M'

"-------------------------
" bistahieversor.nvim
"-------------------------
lua << EOF
local bistahieversor = require('bistahieversor')

bistahieversor.setup({ maxcount = 1000, echo_wrapscan = true })
vim.keymap.set({'n', 'x', 'o'}, 'n', function() bistahieversor.n_and_echo() end)
vim.keymap.set({'n', 'x', 'o'}, 'N', function() bistahieversor.N_and_echo() end)
EOF

"-------------------------
" undotree
"-------------------------
if has("persistent_undo")
   let target_path = expand('$HOME\AppData\Local\nvim\.undodir')

    " create the directory and any parent directories
    " if the location does not exist.
    if !isdirectory(target_path)
        call mkdir(target_path, "p", 0700)
    endif

    let &undodir=target_path
    set undofile
endif

"-------------------------
" nvim-dap
"-------------------------
" ä»®æƒ³ç’°å¢ƒã‚’æŒ‡å®šã—ã¦dap-pythonã‚’èµ·å‹•ã™ã‚‹
function! InstallVirtualEnv()
  if expand('%:e') == 'py'
    let g:python_env_path = expand('%:p:h') . '/env'

    if !isdirectory(g:python_env_path)
      lua vim.ui.select({ 'Create', 'Select' }, {
            \        prompt = 'Python virtual environment not found. Would you like to create or select one?',
            \        }, function(choice)
            \          vim.g.exec_choice = choice
            \        end)
      if g:exec_choice == 'Create' || g:exec_choice == 'Select'
        let g:python_env_path = input('VirtualEnvPath: ', g:python_env_path)
        " Selectã®å ´åˆã¯ãƒ‘ã‚¹ãŒå­˜åœ¨ã™ã‚‹ã‹åˆ¤å®šã™ã‚‹
        if g:exec_choice == 'Select'
          if !isdirectory(g:python_env_path)
            let e = input('Python virtual environment not found. Create?(y/n)')
            if e != 'y'
              echo 'Not created.'
              return
            endif
          endif
        endif
        " ä»®æƒ³ç’°å¢ƒã¨å„ç¨®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
        let upgrade_pip = g:python_env_path . '/Scripts/python.exe -m pip install --upgrade pip'
        let install_debugpy = 'pip install debugpy'
        call system('python -m venv ' . g:python_env_path)
        call system(g:python_env_path . '/Scripts/Activate'. ' && ' . upgrade_pip . ' && ' . install_debugpy)
        echo ' Created a VirtualEnv.'
      else
        echo ' Did Not Create a VirtualEnv.'
      endif
    endif

    let g:launch_path = g:python_env_path . '/Scripts/python'
    lua require('dap-python').setup(vim.g.launch_path)
  endif
endfunction

call InstallVirtualEnv()

" pip installã‚³ãƒãƒ³ãƒ‰
command! Pip call PipInstallInEnv()
function! PipInstallInEnv()
  if !isdirectory(expand('%:p:h') . '/env')
    echo 'not exists ''./env'''
    return
  endif
  let &shell='powershell'
  let &shellcmdflag = '-c'
  let env = expand('%:p:h') . '/env' . '/Scripts/Activate.ps1'
  let cmd = input('command: ', 'pip install ')
  exec 'split | wincmd j | resize 10 | terminal '. env . ' ; ' . cmd
endfunction

command! PipCopy call PipCopy()
function! PipCopy()
  if !isdirectory(expand('%:p:h') . '/env')
    echo 'not exists ''./env'''
    return
  endif
  let &shell='powershell'
  let &shellcmdflag = '-c'
  let env = expand('%:p:h') . '/env' . '/Scripts/Activate.ps1'
  let cmd = input('command: ', 'pip freeze > requirements.txt')
  exec 'split | wincmd j | resize 10 | terminal '. env . ' ; ' . cmd
endfunction

lua require('dapui').setup()
lua require("nvim-dap-virtual-text").setup()

nnoremap <silent> <F4> <cmd>lua require'dapui'.toggle()<CR>
nnoremap <silent> <F5> <cmd>lua require'dap'.continue()<CR>
nnoremap <silent> <F10> <cmd>lua require'dap'.step_over()<CR>
nnoremap <silent> <F11> <cmd>lua require'dap'.step_into()<CR>
nnoremap <silent> <F12> <cmd>lua require'dap'.step_out()<CR>
nnoremap <silent> <Leader>b <cmd>lua require'dap'.toggle_breakpoint()<CR>
nnoremap <silent> <Leader>B <cmd>lua require'dap'.set_breakpoint(vim.fn.input('Breakpoint condition: '))<CR>
nnoremap <silent> <Leader>lp <cmd>lua require'dap'.set_breakpoint(nil, nil, vim.fn.input('Log point message(ex:{var}): '))<CR>
nnoremap <silent> <Leader>dr <cmd>lua require'dap'.repl.open()<CR>
nnoremap <silent> <Leader>dl <cmd>lua require'dap'.run_last()<CR>

lua vim.fn.sign_define('DapBreakpoint', {text='ğŸ›‘', texthl='', linehl='', numhl=''})

"-------------------------
" vim-quickui
"-------------------------
" clear all the menus
call quickui#menu#reset()
let g:quickui_border_style = 2

" install a 'File' menu, use [text, command] to represent an item.
call quickui#menu#install('&File', [
            \ [ "&New File", ':call OpenFile()' ],
            \ [ "&Open File\tSpace fb", ':Telescope file_browser' ],
            \ [ "&Close\tCtrl+w c", ':close' ],
            \ [ "--", '' ],
            \ [ "&Save\tCtrl+s", ':w'],
            \ [ "Save &As", ':call SaveasFile()' ],
            \ [ "Save All\t:wa", ':wa' ],
            \ [ "Change&Encode", 'call ChangeEncode()' ],
            \ [ "Rename", 'call RenameCurrentFile()' ],
            \ [ "--", '' ],
            \ [ "Open $&MYVIMRC", ':e $MYVIMRC' ],
            \ [ "Source $M&YVIMRC", ':source $MYVIMRC' ],
            \ [ "--", '' ],
            \ [ "E&xit\t:qa", ':qa' ],
            \ ])

" items containing tips, tips will display in the cmdline
call quickui#menu#install('&Edit', [
            \ [ '&Undo', ':undo' ],
            \ [ '&Redo', ':redo' ],
            \ [ '--', ''],
            \ [ '&Copy', 'y' ],
            \ [ '&Paste', 'p' ],
            \ [ '--', ''],
            \ [ '&Find', ':call SearchFile()' ],
            \ [ 'R&eplace', ':call ReplaceWord()' ],
            \ ])

call quickui#menu#install ('&View', [
            \ [ "&Switch Buffer\tCtrl+b", 'call quickui#tools#list_buffer(''tabedit'')' ],
            \ [ '--', ''],
            \ [ "Find &files\tSpace ff", ':Telescope find_files' ],
            \ [ "File &browser\tSpace fb", ':Telescope file_browser' ],
            \ [ "Live &grep\tSpace fg", ':Telescope live_grep' ],
            \ [ '--', ''],
            \ [ "Open &Neotree\tSpace e", ':Neotree' ],
            \ [ "Open &Undotree\tSpace u", ':UndotreeToggle' ],
            \ [ "Open Neog&it\t:Neogit", ':Neogit' ],
            \ [ "Open &Mason\t:Mason", ':Mason' ],
            \ [ '--', ''],
            \ [ "Open T&erminal\t:T", ':T' ],
            \ [ '--', ''],
            \ [ "Open TSInstallInfo\t:TSInstallInfo", ':TSInstallInfo' ],
            \ [ "Open TS&Playground\tSpace ;", ':TSPlaygroundToggle' ],
            \ [ "Edit TS&QueryUser\tSpace '", 'call OpenUserSettingHi()' ],
            \ [ "Edit TSQuery&Default\tSpace \"", 'call OpenSettingHi()' ],
            \])

" script inside %{...} will be evaluated and expanded in the string
call quickui#menu#install("&Option", [
            \ ['Set &Wrap %{&wrap? "Off":"On"}', 'set wrap!'],
            \ ['Set &Relativenumber %{&relativenumber? "Off":"On"}', 'set relativenumber!'],
            \ ['Set &Cursor Line %{&cursorline? "Off":"On"}', 'set cursorline!'],
            \ ['Set &Spell %{&spell? "Off":"On"}', 'set spell!'],
            \ ['Set &Paste %{&paste? "Off":"On"}', 'set paste!'],
            \ ])

call quickui#menu#install("&Run", [
            \ ["Start Debugging\t<F5>", ':lua require''dap''.continue()'],
            \ ["Step Over\t<F10>", ':lua require''dap''.step_over()'],
            \ ["Step Into\t<F11>", ':lua require''dap''.step_into()'],
            \ ["Step Out\t<F12>", ':lua require''dap''.step_out()'],
            \ [ '--', ''],
            \ ["Toggle Breakpoint\tSpace b", ':lua require''dap''.toggle_breakpoint()'],
            \ ["Set Breakpoint With Conditions\tSpace B", ':lua require''dap''.set_breakpoint(vim.fn.input(''Breakpoint condition: ''))'],
            \ ["Logpoints\tSpace lp", ':lua require''dap''.set_breakpoint(nil, nil, vim.fn.input(''Log point message (ex:{var}): ''))'],
            \ [ '--', ''],
            \ ["Toggle ui\t<F4>", ':lua require''dapui''.toggle()'],
            \ ], '<auto>', 'python,ps1,typescriptreact')

" register HELP menu with weight 10000
call quickui#menu#install('&Help', [
            \ ["&Cheatsheet", 'help index', ''],
            \ ['T&ips', 'help tips', ''],
            \ ['--',''],
            \ ["&Tutorial", 'help tutor', ''],
            \ ['&Quick Reference', 'help quickref', ''],
            \ ['&Summary', 'help summary', ''],
            \ ], 10000)

" enable to display tips in the cmdline
let g:quickui_show_tip = 1

" åˆ¥åã§ä¿å­˜
function! SaveasFile()
  exec ':saveas ' quickui#input#open('Enter file name:')
endfunction
" ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã
function! OpenFile()
  exec ':e ' quickui#input#open('Enter file name:')
endfunction
" ãƒ•ã‚¡ã‚¤ãƒ«å†…æ¤œç´¢
function! SearchFile()
  let @/ = quickui#input#open('Enter search word:')
  exec 'normal /' . @/ . '\<CR>'
endfunction
" ç½®æ›
function! ReplaceWord()
  let before = quickui#input#open('Enter before word:')
  let after = quickui#input#open('Enter after word:')
  let cmd = ':%s/'
  exec ':%s/' . before . '/' . after . '/gc'
endfunction
" Treesitterã®ãƒã‚¤ãƒ©ã‚¤ãƒˆè¨­å®šã‚’è¡¨ç¤º
function! OpenUserSettingHi()
  let file = quickui#input#open('Enter filetype')
  exec ':TSEditQueryUserAfter highlights ' . file
endfunction
function! OpenSettingHi()
  let file = quickui#input#open('Enter filetype')
  exec ':TSEditQuery highlights ' . file
endfunction

" hit space twice to open menu
noremap <silent> <space><space> :call quickui#menu#open()<CR>

" Custom Theme
if v:vim_did_enter
  hi! QuickBG guifg=#c9d1d9 guibg=NONE "#24292e
  hi! QuickSel gui=bold guifg=#c9d1d9 guibg=#39414a
  hi! QuickKey gui=bold guifg=#b392f0
  hi! QuickDefaultBorder guifg=#c9d1d9 guibg=NONE "#24292e
  hi! QuickDefaultInput guifg=#c9d1d9 guibg=NONE
else
  autocmd VimEnter * hi! QuickBG guifg=#c9d1d9 guibg=NONE "#24292e
  autocmd VimEnter * hi! QuickSel gui=bold guifg=#c9d1d9 guibg=#39414a
  autocmd VimEnter * hi! QuickKey gui=bold guifg=#b392f0
  autocmd VimEnter * hi! QuickDefaultBorder guifg=#c9d1d9 guibg=NONE "#24292e
  autocmd VimEnter * hi! QuickDefaultInput guifg=#c9d1d9 guibg=NONE
endif

" ãƒãƒ¼ãƒãƒ«ãƒ¢ãƒ¼ãƒ‰æ™‚ã®å³ã‚¯ãƒªãƒƒã‚¯ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼
let ncontent = [
            \ ["Goto Definition\tgd", 'exec "lua vim.lsp.buf.definition()"'],
            \ ["Open References\tgr", 'exec "Lspsaga lsp_finder"'],
            \ ["Formatting\tgf", 'exec "lua vim.lsp.buf.formatting()"'],
            \ ["Open Code Action\tga", 'exec "Lspsaga code_action"'],
            \ ["Open Diagnostics\tgx", 'exec ":TroubleToggle document_diagnostics"'],
            \ ['-'],
            \ ["Cut\tdd", 'exec "normal dd"'],
            \ ["Copy\tyy", 'exec "normal yy"'],
            \ ["Paste\tp", 'exec "normal p"'],
            \ ["Paste from register", ':Registers'],
            \ ['-'],
            \ ["Highlight word under cursor\tSpace m", 'exec ":call quickhl#manual#this(''n'')"'],
            \ ["Reset Highlight\tSpace M", 'exec ":call quickhl#manual#reset()"'],
            \ ['-'],
            \ ["Close Window\t:close", ':close'],
            \ ]
" set cursor to the last position
let opts = {'index':g:quickui#context#cursor}
noremap <RightMouse> <cmd>call quickui#context#open(ncontent, opts)<CR>
nnoremap J <cmd>call quickui#context#open(ncontent, opts)<CR>

" ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ¢ãƒ¼ãƒ‰æ™‚ã®å³ã‚¯ãƒªãƒƒã‚¯ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼
let vcontent = [
            \ ["Goto Definition\tgd", 'exec "lua vim.lsp.buf.definition()"'],
            \ ["Open References\tgr", 'exec "Lspsaga lsp_finder"'],
            \ ["Formatting\tgf", 'exec "lua vim.lsp.buf.formatting()"'],
            \ ["Open Code Action\tga", 'exec "Lspsaga code_action"'],
            \ ["Open Diagnostics\tgx", 'exec ":TroubleToggle document_diagnostics"'],
            \ ['-'],
            \ ["Cut\td", 'exec "normal d"'],
            \ ["Copy\ty", 'exec "normal y"'],
            \ ["Paste\tp", 'exec "normal p"'],
            \ ["Paste from register", ':Registers'],
            \ ['-'],
            \ ["Highlight word under cursor\tSpace m", 'exec ":call quickhl#manual#this(''v'')"'],
            \ ["Reset Highlight\tSpace M", 'exec ":call quickhl#manual#reset()"'],
            \ ['-'],
            \ ["Close Window\t:close", ':close'],
            \ ]
" set cursor to the last position
let opts = {'index':g:quickui#context#cursor}
vnoremap <RightMouse> <cmd>call quickui#context#open(vcontent, opts)<CR>


"==================================================
"
" ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
"
"==================================================
"-------------------------
" Powershell or ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’é–‹ã
"-------------------------
function! SetShell()
    let &shell = has('win32') ? 'powershell' : 'pwsh'
    let &shellcmdflag = '-NoLogo -NoProfile -ExecutionPolicy RemoteSigned -Command [Console]::InputEncoding=[Console]::OutputEncoding=[System.Text.Encoding]::UTF8;'
    let &shellredir = '2>&1 | Out-File -Encoding UTF8 %s; exit $LastExitCode'
    let &shellpipe = '2>&1 | Out-File -Encoding UTF8 %s; exit $LastExitCode'
endfunction
set shellquote= shellxquote=
command! -nargs=* T call SetShell() | split | wincmd j | resize 10 | terminal <args>
autocmd TermOpen * startinsert

"-------------------------
" ãƒªãƒãƒ¼ãƒ é–¢æ•°å‘¼ã³å‡ºã—
"-------------------------
" vimä¸Šã§ã€Œã‚¹ãƒšãƒ¼ã‚¹ã‚­ãƒ¼ + nã€ã§ãƒªãƒãƒ¼ãƒ å‡¦ç†ãŒè¡Œãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚
map <leader>n :call RenameCurrentFile()<CR>

function! RenameCurrentFile()
  let old = expand('%')
  let new = input('æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«å: ', old , 'file')
  if new != '' && new != old
    exec ':saveas ' . new
    exec ':silent !rm ' . old
    redraw!
  endif
endfunction


"-------------------------
" Markdownã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’ãƒˆã‚°ãƒ«
"-------------------------
autocmd BufNewFile,BufRead *.md nnoremap <leader>c :ToggleMarkdownCheckbox<CR>
command! ToggleMarkdownCheckbox call s:toggle_checkbox()
function! s:toggle_checkbox()
  let rowText = getline(line('.'))
  if rowText =~ '-\s\[\s\]'
    exec ':s/-\s\[\s\]/- \[x\]'
    exec 'normal $'
  elseif rowText =~ '-\s\[x\]'
    exec ':s/-\s\[x\]/- \[ \]'
    exec 'normal $'
  else
    echo 'Checkbox does not exist at cursor line.'
  endif
endfunction

"-------------------------
" é–‹ã„ã¦ã„ã‚‹ãƒãƒƒãƒ•ã‚¡ã®ãƒ•ã‚©ãƒ«ãƒ€ãƒ‘ã‚¹ã‚’å–å¾—
"-------------------------
command! CopyPath call CopyPath()
function! CopyPath()
  let @* = expand('%:p')
  echo 'Copied : ' . @*
endfunction

"-------------------------
" ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãŒå½“ãŸã£ã¦ã„ã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã¿relativenumberã‚’æœ‰åŠ¹
"-------------------------
augroup numbertoggled
    autocmd!
    autocmd BufEnter,FocusGained,WinEnter   * if &nu && mode() != "i"   | set relativenumber    | endif
    autocmd BufLeave,FocusLost,WinLeave     * if &nu                    | set nornu             | endif
augroup END

"-------------------------
" æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ã¦é–‹ãç›´ã™
"-------------------------
function! ChangeEncode()
lua vim.ui.select({ 'shiftjis', 'utf-8', 'utf-16le' }, {
\         prompt = 'Select encode:',
\     }, function(choice)
\         if choice == 'shiftjis' then
\             vim.cmd(':e ++enc=shift_jis')
\         elseif choice == 'utf-8' then
\             vim.cmd(':e ++enc=utf-8')
\         elseif choice == 'utf-16le' then
\             vim.cmd(':e ++enc=utf-16le')
\         end
\     end)
endfunction
command! ChangeEncode call ChangeEncode()

"-------------------------
" ãƒ“ãƒ«ãƒ‰ã‚¤ãƒ³LSPã®è¨­å®š
"-------------------------
lua << EOF
-- keyboard shortcut
-- å¤‰æ•°ã®æƒ…å ±ã‚’è¡¨ç¤º
--vim.keymap.set('n', 'K',  '<cmd>lua vim.lsp.buf.hover()<CR>')
-- ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’æ•´ãˆã‚‹
vim.keymap.set('n', 'gf', '<cmd>lua vim.lsp.buf.formatting()<CR>')
-- å®šç¾©,å‚ç…§ã‚’è¡¨ç¤º
vim.keymap.set('n', 'gr', '<cmd>Lspsaga lsp_finder<CR>')
-- ã‚¨ãƒ©ãƒ¼ãƒ»ãƒ’ãƒ³ãƒˆã‚’ãƒªã‚¹ãƒˆè¡¨ç¤º
vim.keymap.set('n', 'gx', '<cmd>TroubleToggle document_diagnostics<CR>')
-- å®šç¾©ã‚¸ãƒ£ãƒ³ãƒ—
vim.keymap.set('n', 'gd', '<cmd>lua vim.lsp.buf.definition()<CR>')
-- å®šç¾©ã‚¸ãƒ£ãƒ³ãƒ—(æ°´å¹³åˆ†å‰²)
vim.keymap.set('n', 'gds', ':split | lua vim.lsp.buf.definition()<CR>', bufopts)
-- å®šç¾©ã‚¸ãƒ£ãƒ³ãƒ—(å‚ç›´åˆ†å‰²)
vim.keymap.set('n', 'gdv', ':vsplit | lua vim.lsp.buf.definition()<CR>', bufopts)
-- float windowã§å®šç¾©ã‚’è¡¨ç¤º
vim.keymap.set('n', 'gD', '<cmd>Lspsaga peek_definition<CR>')
-- å¤‰æ•°åã®ãƒªãƒãƒ¼ãƒ 
vim.keymap.set('n', 'gn', '<cmd>Lspsaga rename<CR>')
-- å®Ÿè¡Œå¯èƒ½ãªä¿®æ­£å€™è£œã‚’è¡¨ç¤º
vim.keymap.set('n', 'ga', '<cmd>Lspsaga code_action<CR>')
-- ç¾åœ¨ã®è¡Œã‚ˆã‚Šä¸‹ã®è¨ºæ–­ã«ã‚¸ãƒ£ãƒ³ãƒ—
vim.keymap.set('n', 'gj', '<cmd>Lspsaga diagnostic_jump_next<CR>')
-- ç¾åœ¨ã®è¡Œã‚ˆã‚Šä¸Šã®è¨ºæ–­ã«ã‚¸ãƒ£ãƒ³ãƒ—
vim.keymap.set('n', 'gk', '<cmd>Lspsaga diagnostic_jump_prev<CR>')
-- ã‚¨ãƒ©ãƒ¼ã®ã¿ã‚¸ãƒ£ãƒ³ãƒ—
vim.keymap.set("n", "gJ", function()
  require("lspsaga.diagnostic").goto_next({ severity = vim.diagnostic.severity.ERROR }) end)
vim.keymap.set("n", "gK", function()
  require("lspsaga.diagnostic").goto_prev({ severity = vim.diagnostic.severity.ERROR }) end)
-- è¡Œã®è¨ºæ–­ã‚’è¡¨ç¤º
vim.keymap.set("n", "gs", "<cmd>Lspsaga show_line_diagnostics<CR>")
-- VirtuelTextã®è¡¨ç¤ºåˆ¶å¾¡
vim.lsp.handlers["textDocument/publishDiagnostics"] = vim.lsp.with(
  vim.lsp.diagnostic.on_publish_diagnostics, { virtual_text = true }
)
-- Reference highlight
vim.cmd [[
set updatetime=500
highlight LspReferenceText  cterm=underline ctermfg=1 ctermbg=8 gui=underline guifg=#A00000 guibg=#104040
highlight LspReferenceRead  cterm=underline ctermfg=1 ctermbg=8 gui=underline guifg=#A00000 guibg=#104040
highlight LspReferenceWrite cterm=underline ctermfg=1 ctermbg=8 gui=underline guifg=#A00000 guibg=#104040
augroup lsp_document_highlight
  autocmd!
augroup END
]]
--  autocmd CursorHold,CursorHoldI * lua vim.lsp.buf.document_highlight()
--  autocmd CursorMoved,CursorMovedI * lua vim.lsp.buf.clear_references()

-- ã‚¢ã‚¤ã‚³ãƒ³è¨­å®š
local signs = {
    Error = "ï™™ ",
    Warn = "ï”© ",
    Hint = "ï µ ",
    Info = "ï‘‰ "
}
for type, icon in pairs(signs) do
    local hl = "DiagnosticSign" .. type
    vim.fn.sign_define(hl, {text = icon, texthl = hl, numhl = hl})
end

-- diagnosticã‚’hoverè¡¨ç¤º
-- ref:https://xbgneb0083.hatenablog.com/entry/2022_6_12_avoid_conflict_lsp_hover
local function on_cursor_hold()
  if vim.lsp.buf.server_ready() then
    -- ç„¡åŠ¹åŒ–
    -- vim.diagnostic.open_float()
    --vim.cmd [[Lspsaga show_cursor_diagnostics]]
  end
end

local diagnostic_hover_augroup_name = "lspconfig-diagnostic"
local function enable_diagnostics_hover()
  vim.api.nvim_create_augroup(diagnostic_hover_augroup_name, { clear = true })
  vim.api.nvim_create_autocmd({ "CursorHold" }, { group = diagnostic_hover_augroup_name, callback = on_cursor_hold })
end

local function disable_diagnostics_hover()
  vim.api.nvim_clear_autocmds({ group = diagnostic_hover_augroup_name })
end

vim.api.nvim_set_option('updatetime', 500)
enable_diagnostics_hover()

-- diagnosticãŒã‚ã‚‹è¡Œã§ãƒ›ãƒãƒ¼ã‚’ã™ã‚‹ã¨ã™ãã«diagnosticã®floating windowã§ä¸Šæ›¸ãã•ã‚Œã¦ã—ã¾ã†ã®ã‚’é˜»æ­¢ã™ã‚‹
-- ãƒ›ãƒãƒ¼ã‚’ã—ãŸã‚‰ä¸€æ™‚çš„ã«diagnosticã‚’é–‹ãautocmdã‚’ç„¡åŠ¹åŒ–ã™ã‚‹
-- ã“ã‚Œã ã‘ã ã¨ãã‚Œä»¥é™diagnosticãŒè‡ªå‹•è¡¨ç¤ºã•ã‚Œãªããªã£ã¦ã—ã¾ã†ã®ã§æœ‰åŠ¹åŒ–ã™ã‚‹autocmdã‚’ä¸€å›ã ã‘ç™ºè¡Œã—ã¦å‰Šé™¤ã™ã‚‹
local function on_hover()
  disable_diagnostics_hover()

--  vim.lsp.buf.hover()
  vim.cmd [[Lspsaga hover_doc]]

  vim.api.nvim_create_augroup("lspconfig-enable-diagnostics-hover", { clear = true })
  -- ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®åˆ‡ã‚Šæ›¿ãˆãªã©ã®ã‚¤ãƒ™ãƒ³ãƒˆãŒçµ¡ã‚“ã§ãã‚‹ã¨ãŠã‹ã—ããªã‚‹ã‹ã‚‚ã—ã‚Œãªã„
  vim.api.nvim_create_autocmd({ "CursorMoved", "CursorMovedI" }, { group = "lspconfig-enable-diagnostics-hover", callback = function()
    vim.api.nvim_clear_autocmds({ group = "lspconfig-enable-diagnostics-hover" })
    enable_diagnostics_hover()
  end })
end
vim.keymap.set('n', 'K', on_hover, opt) -- å¤‰æ•°ã®æƒ…å ±ã‚’è¡¨ç¤º
EOF

"-------------------------
" Vimã®å‹•ä½œãƒ­ã‚°ã‚’å–å¾—
"-------------------------
command! Profile call s:command_profile()
function! s:command_profile() abort
  profile start profile.txt
  profile func *
  profile file *
endfunction

"-------------------------
" ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’ä¸Šæ›¸ãè¨­å®š
"-------------------------
" è¡Œç•ªå·
hi LineNr guifg=#6a737d
hi clear CursorLine
" TreeSitter
hi Keyword gui=NONE
if expand('%:e') == 'tsx'
    hi @tag guifg=#85e89d
    hi @punctuation.bracket guifg=#ffab70
    hi @punctuation.delimiter guifg=#c9d1d9
    hi @variable guifg=#79b8ff
    hi @property guifg=#c9d1d9
    hi @tag.attribute guifg=#b392f0
    hi @tag.delimiter guifg=#c9d1d9
    hi @parameter guifg=#ffab70
    hi @type.builtin guifg=#79b8ff 
endif
" floating window
hi NormalFloat guibg=NONE
hi FloatBorder guibg=#24292e
" vim-bookmarks
hi BookmarkSign guifg=#157efb
hi BookmarkAnnotationSign guifg=#157efb
hi BookmarkLine guifg=#157efb
hi BookmarkAnnotationLine guifg=#157efb
" noice.nvim
" hi NoiceCmdlinePopupBorder guifg=#79b8ff
" hi NoiceCmdlinePopupBorderSearch guifg=#ffab70
